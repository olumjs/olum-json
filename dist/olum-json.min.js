/**
* @name olum-json
* @version 0.2.0
* @copyright 2022
* @author Eissa Saber
* @license MIT
*/
"use strict";function _toConsumableArray(n){return _arrayWithoutHoles(n)||_iterableToArray(n)||_unsupportedIterableToArray(n)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(n,t){if(n){if("string"==typeof n)return _arrayLikeToArray(n,t);var a=Object.prototype.toString.call(n).slice(8,-1);return"Map"===(a="Object"===a&&n.constructor?n.constructor.name:a)||"Set"===a?Array.from(n):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?_arrayLikeToArray(n,t):void 0}}function _iterableToArray(n){if("undefined"!=typeof Symbol&&null!=n[Symbol.iterator]||null!=n["@@iterator"])return Array.from(n)}function _arrayWithoutHoles(n){if(Array.isArray(n))return _arrayLikeToArray(n)}function _arrayLikeToArray(n,t){(null==t||t>n.length)&&(t=n.length);for(var a=0,e=new Array(t);a<t;a++)e[a]=n[a];return e}function _typeof(n){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n})(n)}!function(n,t){"object"===("undefined"==typeof module?"undefined":_typeof(module))&&module.exports?module.exports=t():"function"==typeof define&&define.amd?define(t):n.OlumJson=t()}("undefined"!=typeof self?self:void 0,function(){return function(n){function v(n){return n.getAttribute("data-prop")&&n.classList.contains("prop")?n.getAttribute("data-prop"):null}function h(n){return(n=n.querySelectorAll(":scope > .prop")).length?_toConsumableArray(n):null}var g=this,k={rightIcon:'<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd" /></svg>',isNull:function(n){return"object"==_typeof(n)&&null===n},isUndefined:function(n){return void 0===n},isObject:function(n){return!this.isNull(n)&&"object"==_typeof(n)&&!Array.isArray(n)},isArray:function(n){return"object"==_typeof(n)&&Array.isArray(n)},isBoolean:function(n){return"boolean"==typeof n},isNumber:function(n){return"number"==typeof n},isString:function(n){return"string"==typeof n},mkBoolean:function(n,t,a,e){var o='<div class="line">',o=null===n?(o=(o+='<span class="index boolean">')+'<span class="item prop" data-prop="'.concat(a,'">').concat(a,'</span><span class="colon">:</span>'))+'<span class="boolean"><span contenteditable data-path="'.concat(e,'" data-type="boolean" data-prop="').concat(n,'">').concat(t,"</span>")+"<button class='saveBtn o-btn' tabindex='-1'></button><button class='delBtn o-btn' tabindex='-1'></button></span></span>":(o=o+'<span class="prop" data-prop="'.concat(n,'">').concat(n,"</span>")+'<span class="colon">:</span>')+'<span class="boolean"><span contenteditable data-path="'.concat(e,'" data-type="boolean" data-prop="').concat(n,'">').concat(t,"</span>")+"<button class='saveBtn o-btn' tabindex='-1'></button><button class='delBtn o-btn' tabindex='-1'></button></span>";return o+="</div>"},mkString:function(n,t,a,e){var o='<div class="line">',o=null===n?(o=(o+='<span class="index string">')+'<span class="item prop" data-prop="'.concat(a,'">').concat(a,'</span><span class="colon">:</span>'))+'<span class="string"><span class="quotes">"</span><span contenteditable data-path="'.concat(e,'" data-type="string" data-prop="').concat(n,'">').concat(t,'</span><span class="quotes">"</span>')+"<button class='saveBtn o-btn' tabindex='-1'></button><button class='delBtn o-btn' tabindex='-1'></button></span></span>":(o=o+'<span class="prop" data-prop="'.concat(n,'">').concat(n,"</span>")+'<span class="colon">:</span>')+'<span class="string"><span class="quotes">"</span><span contenteditable data-path="'.concat(e,'" data-type="string" data-prop="').concat(n,'">').concat(t,'</span><span class="quotes">"</span>')+"<button class='saveBtn o-btn' tabindex='-1'></button><button class='delBtn o-btn' tabindex='-1'></button></span>";return o+="</div>"},mkNumber:function(n,t,a,e){var o='<div class="line">',o=null===n?(o=(o+='<span class="index number">')+'<span class="item prop" data-prop="'.concat(a,'">').concat(a,'</span><span class="colon">:</span>'))+'<span class="number"><span contenteditable data-path="'.concat(e,'" data-type="number" data-prop="').concat(n,'">').concat(t,"</span>")+"<button class='saveBtn o-btn' tabindex='-1'></button><button class='delBtn o-btn' tabindex='-1'></button></span></span>":(o=o+'<span class="prop" data-prop="'.concat(n,'">').concat(n,"</span>")+'<span class="colon">:</span>')+'<span class="number"><span contenteditable data-path="'.concat(e,'" data-type="number" data-prop="').concat(n,'">').concat(t,"</span>")+"<button class='saveBtn o-btn' tabindex='-1'></button><button class='delBtn o-btn' tabindex='-1'></button></span>";return o+="</div>"},mkNull:function(n,t,a,e){var o='<div class="line">',o=null===n?(o=(o+='<span class="index null">')+'<span class="item prop" data-prop="'.concat(a,'">').concat(a,'</span><span class="colon">:</span>'))+'<span class="null"><span contenteditable data-path="'.concat(e,'" data-type="null" data-prop="').concat(n,'">').concat(t,"</span>")+"<button class='saveBtn o-btn' tabindex='-1'></button><button class='delBtn o-btn' tabindex='-1'></button></span></span>":(o=o+'<span class="prop" data-prop="'.concat(n,'">').concat(n,"</span>")+'<span class="colon">:</span>')+'<span class="null"><span contenteditable data-path="'.concat(e,'" data-type="null" data-prop="').concat(n,'">').concat(t,"</span>")+"<button class='saveBtn o-btn' tabindex='-1'></button><button class='delBtn o-btn' tabindex='-1'></button></span>";return o+="</div>"},mkUndefined:function(n,t,a,e){var o='<div class="line">',o=null===n?(o=(o+='<span class="index undefined">')+'<span class="item prop" data-prop="'.concat(a,'">').concat(a,'</span><span class="colon">:</span>'))+'<span class="undefined"><span contenteditable data-path="'.concat(e,'" data-type="undefined" data-prop="').concat(n,'">').concat(t,"</span>")+"<button class='saveBtn o-btn' tabindex='-1'></button><button class='delBtn o-btn' tabindex='-1'></button></span></span>":(o=o+'<span class="prop" data-prop="'.concat(n,'">').concat(n,"</span>")+'<span class="colon">:</span>')+'<span class="undefined"><span contenteditable data-path="'.concat(e,'" data-type="undefined" data-prop="').concat(n,'">').concat(t,"</span>")+"<button class='saveBtn o-btn' tabindex='-1'></button><button class='delBtn o-btn' tabindex='-1'></button></span>";return o+="</div>"},mkArray:function(n,t){var e="";return function a(n,t){e+='<div class="line caret">';e+='<span class="indentation"></span>';e+='<span class="prop" data-prop="'.concat(n,"\"><span class='collapse'>").concat(k.rightIcon,"</span>").concat(n,"</span>");e+='<span class="colon">:</span>';e+='<span class="array">Array<span class="length"><span class="bracket">(</span>'.concat(t.length,"<span class=\"bracket\">)</span></span>\n            <button class='o-btn addBtn' tabindex='-1'></button>\n            <button class='o-btn delWrapperBtn' tabindex='-1'></button>\n          </span>");t.forEach(function(n,t){k.isBoolean(n)?e+=k.mkBoolean(null,n,t):k.isString(n)?e+=k.mkString(null,n,t):k.isNumber(n)?e+=k.mkNumber(null,n,t):k.isNull(n)?e+=k.mkNull(null,n,t):k.isUndefined(n)?e+=k.mkUndefined(null,n,t):k.isObject(n)?e+=k.mkObject(t,n):k.isArray(n)&&a(t,n)});e+="</div>"}(n,t),e},mkObject:function(n,t){var r="0root."+n,s=r,l="";return function a(e,o){var n=Object.keys(o);l+='<div class="line caret">';l+='<span class="indentation"></span>';l+='<span class="prop" data-prop="'.concat(e,"\"><span class='collapse'>").concat(k.rightIcon,"</span>").concat(e,"</span>");l+='<span class="colon">:</span>';l+='<span class="object">Object<span class="length"><span class="bracket">{</span>'.concat(n.length,"<span class=\"bracket\">}</span></span>\n            <button class='o-btn addBtn' tabindex='-1'></button>\n            <button class='o-btn delWrapperBtn' tabindex='-1'></button>\n          </span>");n.forEach(function(n){var t=o[n];k.isBoolean(t)?l+=k.mkBoolean(n,t,null,s+"."+n):k.isString(t)?l+=k.mkString(n,t,null,s+"."+n):k.isNumber(t)?l+=k.mkNumber(n,t,null,s+"."+n):k.isNull(t)?l+=k.mkNull(n,t,null,s+"."+n):k.isUndefined(t)?l+=k.mkUndefined(n,t,null,s+"."+n):k.isArray(t)?l+=k.mkArray(n,t):k.isObject(t)&&(s+="."+n,a(n,t),s=r+"."+e)});l+="</div>"}(n,t),l}};function x(n,t,a){var e;return a?n.split(".").slice(1).reduce(function(n,t){return(n||{})[t]},t)||(console.warn("wrong path! @ "+n),null):(e=(a=n.split(".").slice(1)).pop(),(a=a.reduce(function(n,t){return(n||{})[t]},t))&&a.hasOwnProperty(e)?{obj:a,name:e}:(console.warn("wrong path! @ "+n),null))}g.render=function(n,t,a){if(!n)return console.warn("wrapper is NOT accessable in DOM!");if(!t)return console.warn("entryPoint is NOT passed!");g.wrapper=n;var f,y,a=function(n,t){var a,e;if(n)return a="",k.isArray(n)?a+=k.mkArray(t||"root",n):k.isObject(n)&&((e={})[t||"root"]=n,Object.keys(e).forEach(function(n){var t;e.hasOwnProperty(n)&&(t=e[n],k.isBoolean(t)?a+=k.mkBoolean(n,t,null,"0root."+n):k.isString(t)?a+=k.mkString(n,t,null,"0root."+n):k.isNumber(t)?a+=k.mkNumber(n,t,null,"0root."+n):k.isNull(t)?a+=k.mkNull(n,t,null,"0root."+n):k.isUndefined(t)?a+=k.mkUndefined(n,t,null,"0root."+n):k.isObject(t)?a+=k.mkObject(n,t):k.isArray(t)&&(a+=k.mkArray(n,t)))})),a}(g.entryPoint=t,g.rootName=a),a=(n.innerHTML=a,n.querySelector(".delWrapperBtn"));a&&a.remove(),y=t,(f=n)&&(f.onclick=function(n){var t,a;function e(n,t){var e,o,r,s,l,c,p,i;if("add"===t)return b=function n(t){var a=h(t);a?(a.forEach(function(n){return v(n)?e.push(v(n)):null}),v(t)&&e.push(v(t)),t.parentElement!==f&&n(t.parentElement)):v(t)?e.push(v(t)):t.parentElement!==f&&n(t.parentElement)},m=(a=n).parentElement.className,d=a.parentElement.parentElement,["","35px"].includes(d.style.height.trim())&&(m=d.querySelector("."+m))&&m.click(),f.querySelectorAll(".lineForm").forEach(function(n){return n.remove()}),e=[],b(a),o=x(e.reverse().join("."),y,!0),r=Array.isArray(o),s=r?o.length:"prop"+((m=Object.keys(o).map(function(n){if(/prop[0-9]/gi.test(n))return+n.replace(/\D/gi,"")}).filter(function(n){return n})).length?Math.max.apply(Math,_toConsumableArray(m))+1:1),b='<div class="line lineForm">\n              <span class="prop lineFormKey" '.concat(r?"":"contenteditable",">").concat(s,'</span>\n              <span class="colon">:</span>\n              <span class="newEntry">\n                <span contenteditable class="lineFormValue">undefined</span>\n                <button class="saveBtn o-btn"></button>\n                <button class="delBtn o-btn"></button>\n              </span>\n            </div>\n            '),void(d.querySelector(".lineForm")||(d.insertAdjacentHTML("beforeend",b),a=(l=d.querySelector(".lineForm")).querySelector(".newEntry .saveBtn"),m=l.querySelector(".newEntry .delBtn"),c=l.querySelector(".lineFormKey"),p=l.querySelector(".lineFormValue"),a.onclick=function(){var n=r?s:c.textContent.trim(),t=p.textContent.trim();if("undefined"===t)t=void 0;else try{t=JSON.parse(t)}catch(n){}console.log({val:t,key:n});var a="",e=(k.isBoolean(t)?a+=k.mkBoolean(n,t,null,"0root."+n):k.isString(t)?a+=k.mkString(n,t,null,"0root."+n):k.isNumber(t)?a+=k.mkNumber(n,t,null,"0root."+n):k.isNull(t)?a+=k.mkNull(n,t,null,"0root."+n):k.isUndefined(t)?a+=k.mkUndefined(n,t,null,"0root."+n):k.isObject(t)?a+=k.mkObject(n,t):k.isArray(t)&&(a+=k.mkArray(n,t)),document.createElement("div")),a=(e.innerHTML=a,e.querySelector(".line"));a&&(r?o.push(t):o[n]=t,l.replaceWith(a))},m.onclick=function(){return l?l.remove():null}));if("delWrapper"===t)return b=function n(t){var a=h(t);a?(a.forEach(function(n){return v(n)?i.push(v(n)):null}),v(t)&&i.push(v(t)),t.parentElement!==f&&n(t.parentElement)):v(t)?i.push(v(t)):t.parentElement!==f&&n(t.parentElement)},a=(d=n).parentElement.className,m=d.parentElement.parentElement,console.log({item:d,className:a,parent:m}),i=[],b(d),d=(b=x(a=i.reverse().join("."),y)).obj,b=b.name,console.log({obj:d,name:b,propPath:a}),void(d[b]&&(console.warn("del"),delete d[b],m.remove()));var u,a=n.parentElement.querySelector("[contenteditable]"),d=a.getAttribute("data-prop"),b=a.getAttribute("data-type"),m=a.getAttribute("data-path");a&&m&&b&&d&&(u=[],function n(t){var a=h(t);a?(a.forEach(function(n){return v(n)?u.push(v(n)):null}),v(t)&&u.push(v(t)),t.parentElement!==f&&n(t.parentElement)):v(t)?u.push(v(t)):t.parentElement!==f&&n(t.parentElement)}(a),d=(m=x(u.reverse().join("."),y)).obj,m=m.name,d&&d[m]&&("save"===t?"string"===b?d[m]=a.textContent:"boolean"===b||null===b?d[m]=JSON.parse(a.textContent.trim()):"number"===b&&(d[m]=+a.textContent.trim()):"delete"===t&&((Array.isArray(d)?n.parentElement:n).parentElement.parentElement.classList.contains("line")?Array.isArray(d)?d[m]&&(d.splice(+m,1),g.render(g.wrapper,g.entryPoint,g.rootName)):(delete d[m],g.render(g.wrapper,g.entryPoint,g.rootName)):console.warn("Couldn't reach the .line class for deletion!"))))}-1!==n.target.className.indexOf("collapse")?35<(a=(t=n.target).parentElement.parentElement).clientHeight?(t.style.transform="rotate(0deg)",a.style.height="35px"):(t.style.transform="rotate(90deg)",a.style.height="auto"):-1===n.target.className.indexOf("array")&&-1===n.target.className.indexOf("object")||(a=(t=n.target.parentElement).querySelector(".collapse"),35<t.clientHeight?(a.style.transform="rotate(0deg)",t.style.height="35px"):(a.style.transform="rotate(90deg)",t.style.height="auto")),-1!==n.target.className.indexOf("saveBtn")?e(n.target,"save"):-1!==n.target.className.indexOf("delBtn")?e(n.target,"delete"):-1!==n.target.className.indexOf("addBtn")?e(n.target,"add"):-1!==n.target.className.indexOf("delWrapper")&&e(n.target,"delWrapper")})}}});